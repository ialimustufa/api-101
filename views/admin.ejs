<body class="font-sans container">
    <% var isValidUrl = function (urlString) {
        try { 
            return Boolean(new URL(urlString)); 
        }
        catch(e){ 
            return false; 
        }
    } %>
    <div class="container">
        <div class="flex flex-wrap" id="tabs-id">
            <div class="w-full">
                <ul class="flex mb-0 list-none flex-wrap pt-3 pb-4 flex-row bg-red-600">
                    <li class="-mb-px mr-2 last:mr-0 flex-auto text-center">
                        <a class="text-xs font-bold uppercase px-5 py-3 shadow-lg rounded block leading-normal text-white bg-pink-600"
                            onclick="changeActiveTab(event,'tab-jokes')">
                            <i class="fas fa-space-shuttle text-base mr-1"></i> Jokes
                        </a>
                    </li>
                    <li class="-mb-px mr-2 last:mr-0 flex-auto text-center">
                        <a class="text-xs font-bold uppercase px-5 py-3 shadow-lg rounded block leading-normal text-pink-600 bg-white"
                            onclick="changeActiveTab(event,'tab-quotes')">
                            <i class="fas fa-cog text-base mr-1"></i> Quotes
                        </a>
                    </li>
                    <li class="-mb-px mr-2 last:mr-0 flex-auto text-center">
                        <a class="text-xs font-bold uppercase px-5 py-3 shadow-lg rounded block leading-normal text-pink-600 bg-white"
                            onclick="changeActiveTab(event,'tab-books')">
                            <i class="fas fa-briefcase text-base mr-1"></i> Books
                        </a>
                    </li>
                </ul>
                <div class="relative flex flex-col min-w-0 break-words bg-white w-full mb-6 shadow-lg rounded">
                    <div class="px-4 py-5 flex-auto">
                        <div class="tab-content tab-space">
                            <div class="block" id="tab-jokes">
                                <div class="overscroll-contain overflow-y-auto border-l-2 bg-gray-100 border-indigo-500 leading-normal"
                                    id="jokes-container">
                                    <% data.jokes.forEach((joke, index) => { %>
                                    <% if(joke) { %>
                                    <div name="joke" id="<%= joke.id %>"
                                        class="card m-2 cursor-pointer shadow-s bg-gray-700 border border-gray-400 rounded-lg hover:shadow-2xl hover:border-opacity-0 transform hover:-translate-y-1 ease-in-out transition-all duration-300">
                                        <div class="m-3">
                                            <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2"><%= joke.author %></span>
                                            <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2 absolute right-0"
                                                onclick="deleteElement(event);"><img class="object-scale-down h-6 w-6" src="https://img.icons8.com/plasticine/30/30/000000/trash--v1.png"/></span>
                                            <p
                                                class="font-medium font-mono text-2xl text-white hover:text-red-500 transition-all duration-200">
                                                <%= joke.joke %></p>
                                            <p class="text-gray-400">
                                                <a class="hover:underline hover:text-red-50" href="<%= joke.source %>"
                                                    target="_blank" referrerpolicy="no-referrer"
                                                    rel="nofollow noreferrer noopener ">Visit
                                                    Source</a></p>
                                        </div>
                                    </div>
                                    <% } %>
                                    <% }); %>
                                </div>
                            </div>
                            <div class="hidden" id="tab-quotes">
                                <div class="overscroll-contain overflow-y-auto border-l-2 bg-gray-100 border-indigo-500 leading-normal"
                                    id="quotes-container">

                                    <% data.quotes.forEach((quote, index) => { %>
                                    <% if(quote) {%>
                                    <div name="quote" id="<%= quote.id %>"
                                        class="card m-2 cursor-pointer shadow-s bg-gray-700 border border-gray-400 rounded-lg hover:shadow-2xl hover:border-opacity-0 transform hover:-translate-y-1 ease-in-out transition-all duration-300">
                                        <div class="m-3">
                                            <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2"><%= quote.author %></span>
                                                <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2 absolute right-0"
                                                onclick="deleteElement(event);"><img class="object-scale-down h-6 w-6" src="https://img.icons8.com/plasticine/30/30/000000/trash--v1.png"/></span>
                                            <p
                                                class="font-medium font-mono text-2xl text-white hover:text-red-500 transition-all duration-200">
                                                <%= quote.quote %></p>
                                            <p class="text-gray-400">
                                                <a class="hover:underline hover:text-red-50" href="<%= quote.source %>"
                                                    target="_blank" referrerpolicy="no-referrer"
                                                    rel="nofollow noreferrer noopener ">Visit
                                                    Source</a></p>
                                        </div>
                                    </div>
                                    <% } %>
                                    <% }); %>
                                </div>
                            </div>
                            <div class="hidden" id="tab-books">
                                <div class="overflow-y-auto border-l-2 bg-gray-100 border-indigo-500 leading-normal"
                                    id="books-container">

                                    <% data.books.forEach((book, index) => { %>
                                    <% if(book) { %>
                                    <div name="book" id="<%= book.id %>"
                                        class="card m-2 cursor-pointer shadow-s bg-gray-700 border border-gray-400 rounded-lg hover:shadow-2xl hover:border-opacity-0 transform hover:-translate-y-1 ease-in-out transition-all duration-300">
                                        <div class="m-3">
                                            <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2"><%= book.author %></span>
                                                <span
                                                class="inline-block bg-gray-100 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2 absolute right-0"
                                                onclick="deleteElement(event);"><img class="object-scale-down h-6 w-6" src="https://img.icons8.com/plasticine/30/30/000000/trash--v1.png"/></span>
                                            <p
                                                class="font-medium font-mono text-2xl text-white hover:text-red-500 transition-all duration-200">
                                                <%= book.book_name %></p>
                                            <p class="text-gray-400">
                                                <a class="hover:underline hover:text-red-50" href="<%= book.link %>"
                                                    target="_blank" referrerpolicy="no-referrer"
                                                    rel="nofollow noreferrer noopener ">Visit
                                                    Source</a></p>
                                        </div>
                                    </div>
                                    <% } %>
                                    <% }); %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function changeActiveTab(event, tabID) {
            let element = event.target;
            while (element.nodeName !== "A") {
                element = element.parentNode;
            }
            ulElement = element.parentNode.parentNode;
            aElements = ulElement.querySelectorAll("li > a");
            tabContents = document.getElementById("tabs-id").querySelectorAll(".tab-content > div");
            for (let i = 0; i < aElements.length; i++) {
                aElements[i].classList.remove("text-white");
                aElements[i].classList.remove("bg-pink-600");
                aElements[i].classList.add("text-pink-600");
                aElements[i].classList.add("bg-white");
                tabContents[i].classList.add("hidden");
                tabContents[i].classList.remove("block");
            }
            element.classList.remove("text-pink-600");
            element.classList.remove("bg-white");
            element.classList.add("text-white");
            element.classList.add("bg-pink-600");
            document.getElementById(tabID).classList.remove("hidden");
            document.getElementById(tabID).classList.add("block");
        }

        function deleteElement(event) {
            axios.delete(`../${event.target.parentNode.parentNode.parentNode.attributes.name.value}/${event.target.parentNode.parentNode.parentNode.id}`)
            .then((response) => {
                event.target.parentNode.parentNode.parentNode.parentNode.removeChild(event.target.parentNode.parentNode.parentNode);
                // alert("click: " + event.target.id);
                })
                .catch(err => {
                    alert(err);
                });
        }
    </script>
</body>

</html>